<!DOCTYPE html>
<html>
<head>
<title>test!!!</title>
<meta charset='utf-8' />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="test.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
</head>
<body>
<header>
<svg class="logo-pgs-dark" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 118 65" style="enable-background:new 0 0 118 65;" height="65" width="118" xml:space="preserve">
<style type="text/css">
    .st0{fill:none;}
    .logo-container-black .st1{fill:#F4762B !important; stroke: none;}
</style>
    <rect class="st0" width="118" height="65"></rect>
    <path d="M91.8,41.4h5.8V42C97.4,42,97.2,42,97,42h-4v5h3.9c0.3,0,0.5,0,0.7-0.1v0.6c-0.2,0-0.4,0-0.7,0H93v5.3h3.9
	c0.1,0,0.3,0,0.7-0.1v0.7h-5.7c0-0.2,0-0.4,0-0.6V42C91.8,41.8,91.8,41.6,91.8,41.4 M83.6,47.2h1.2c0.6,0,1.2-0.1,1.7-0.4
	c0.8-0.5,1.3-1.2,1.3-2.2c0-0.4-0.1-0.9-0.3-1.2c-0.2-0.4-0.5-0.7-0.8-0.9c-0.5-0.3-1.2-0.5-2.1-0.5h-1.1L83.6,47.2L83.6,47.2z
	 M83.6,47.7v5.1c0,0.2,0,0.4,0.1,0.6h-1.3c0-0.2,0.1-0.4,0.1-0.6V42c0-0.2,0-0.4-0.1-0.6h2.7c0.8,0,1.5,0.1,2.1,0.4
	c0.5,0.2,1,0.6,1.3,1c0.4,0.5,0.5,1.1,0.5,1.7c0,0.9-0.3,1.7-1,2.2c-0.7,0.5-1.6,0.8-2.9,0.9l4.8,5.3c0.1,0.2,0.3,0.3,0.5,0.4h-1.8
	c-0.1-0.1-0.2-0.3-0.3-0.5L83.6,47.7z M73.6,48.8h4.7l-2.4-6.2L73.6,48.8z M73.4,49.3l-1.4,3.6c0,0.1-0.1,0.2-0.1,0.5h-0.7
	c0.1-0.2,0.2-0.3,0.2-0.5l4.1-11.1c0-0.1,0.1-0.2,0.1-0.4h1.1c0,0.1,0,0.2,0.1,0.3l4.3,11.2c0,0.1,0.1,0.3,0.3,0.5H80
	c0-0.2,0-0.3-0.1-0.5l-1.4-3.6L73.4,49.3L73.4,49.3z M64.7,42.7l-2.9,10.2c0,0.1-0.1,0.2-0.1,0.5h-1.1c0-0.2,0-0.4-0.1-0.6
	l-2.9-10.8c0-0.2-0.1-0.3-0.2-0.5h1.2c0,0,0,0,0,0c0,0,0,0.2,0.1,0.4L61.5,52l2.9-10.1c0-0.2,0.1-0.3,0.1-0.4c0,0,0-0.1,0-0.1h1.2
	c0,0,0,0.1,0,0.1c0,0.1,0,0.2,0.1,0.4l3,10.1l2.7-10.1c0-0.2,0.1-0.3,0.1-0.4h0.6c0,0.1-0.1,0.2-0.2,0.4l-3,11
	c0,0.1-0.1,0.2-0.1,0.5h-1.1c0-0.2,0-0.4-0.1-0.6L64.7,42.7z M48,41.4h8.6v0.7C56.2,42,55.9,42,55.7,42h-2.9v10.7
	c0,0.2,0,0.4,0.1,0.6h-1.3c0-0.2,0.1-0.4,0.1-0.6V42h-3c-0.2,0-0.5,0-0.8,0.1L48,41.4L48,41.4z M41.1,41.4h5.7V42
	c-0.2,0-0.4-0.1-0.7-0.1h-3.8V47h3.3c0.2,0,0.4,0,0.6-0.1v0.6c-0.2,0-0.4-0.1-0.6-0.1h-3.3v5.3c0,0.2,0,0.4,0.1,0.6h-1.3
	c0-0.2,0.1-0.4,0.1-0.6V42C41.2,41.8,41.1,41.6,41.1,41.4z M33.9,41.9c-1.6,0-2.7,0.5-3.5,1.6c-0.7,1-1,2.2-1,3.8c0,1.7,0.3,3,1,4
	c0.8,1.1,2,1.6,3.6,1.6c1.5,0,2.7-0.5,3.5-1.5c0.7-1,1.1-2.3,1.1-4c0-1.7-0.4-3-1.1-4c-0.4-0.5-0.9-0.9-1.5-1.2
	C35.4,42,34.7,41.9,33.9,41.9z M34,41.3c1.8,0,3.3,0.5,4.3,1.6c1.1,1.1,1.6,2.6,1.6,4.5c0,2-0.5,3.5-1.6,4.6c-1,1-2.4,1.6-4.3,1.6
	c-1.9,0-3.4-0.5-4.4-1.6c-1-1.1-1.5-2.6-1.5-4.6c0-1.9,0.5-3.3,1.6-4.4C30.7,41.8,32.1,41.3,34,41.3z M20,52.6l0.3-1
	c0.3,0.2,0.5,0.4,0.8,0.6c0.6,0.4,1.3,0.6,2.1,0.6c0.9,0,1.6-0.3,2.1-0.8c0.4-0.4,0.6-1,0.6-1.6c0-0.8-0.3-1.4-0.9-1.9
	C24.7,48.3,24,48,23,47.5c-1-0.5-1.7-0.9-2.1-1.4c-0.5-0.5-0.8-1.2-0.8-1.9c0-0.6,0.2-1.1,0.5-1.6c0.7-0.9,1.7-1.4,3.2-1.4
	c0.9,0,1.7,0.2,2.6,0.6l-0.3,0.8c-0.9-0.5-1.7-0.8-2.5-0.8c-0.8,0-1.4,0.2-1.9,0.7c-0.4,0.4-0.6,0.9-0.6,1.4c0,0.5,0.2,1,0.5,1.4
	c0.4,0.4,1.1,0.8,2.1,1.3c0.7,0.3,1.2,0.6,1.5,0.8c0.3,0.2,0.6,0.4,0.8,0.6c0.6,0.6,0.9,1.3,0.9,2.1c0,0.6-0.2,1.2-0.5,1.7
	c-0.7,1.1-1.8,1.6-3.4,1.6C22,53.5,21,53.2,20,52.6z"></path>
    <path d="M63.7,36.6l0.7-2.2c0.6,0.5,1.2,1,1.6,1.3c1.3,0.9,2.9,1.4,4.5,1.4c1.9,0,3.4-0.6,4.5-1.8c0.9-1,1.4-2.2,1.4-3.6
	c0-1.7-0.7-3.1-2-4.2c-0.6-0.5-1.9-1.2-4.1-2.3c-2.2-1.1-3.7-2.1-4.6-3c-1.2-1.2-1.7-2.5-1.7-4.2c0-1.3,0.4-2.5,1.2-3.6
	c1.5-2,3.8-3,6.9-3c1.8,0,3.7,0.4,5.6,1.3l-0.7,1.8c-1.9-1.2-3.7-1.8-5.3-1.8c-1.7,0-3,0.5-4,1.6c-0.8,0.9-1.2,1.9-1.2,3.1
	c0,1.2,0.4,2.2,1.2,3c0.8,0.8,2.3,1.8,4.5,2.9c1.5,0.7,2.6,1.3,3.3,1.8c0.7,0.4,1.2,0.9,1.7,1.4c1.3,1.4,1.9,2.9,1.9,4.7
	c0,1.3-0.4,2.6-1.1,3.8c-1.5,2.4-4,3.6-7.3,3.6C68.1,38.5,65.9,37.9,63.7,36.6 M23.2,24.9h3.1c1.5,0,2.8-0.2,3.7-0.6
	c1-0.4,1.8-1.1,2.4-2c0.6-1,0.9-2.1,0.9-3.4c0-1.8-0.6-3.2-1.8-4.3c-1.2-1-2.8-1.6-4.8-1.6h-3.6L23.2,24.9L23.2,24.9z M51.7,23.8h8
	c-0.1,0.4-0.1,0.9-0.1,1.2v10.2c0,0.5,0.1,1,0.3,1.4c-2.1,0.7-3.7,1.2-4.9,1.5c-1.2,0.2-2.5,0.4-3.9,0.4c-3.8,0-6.7-1.2-8.9-3.5
	c-2.3-2.6-3.5-5.9-3.5-10.1c0-4.5,1.4-8,4.2-10.5c2.2-2,5.2-2.9,8.9-2.9c1.2,0,2.3,0.1,3.4,0.3c1,0.2,2.3,0.6,3.7,1.2v2.3
	c-2.6-1.5-5.1-2.3-7.5-2.3c-2.8,0-5.1,0.9-6.9,2.8c-1.1,1.1-1.8,2.3-2.2,3.7c-0.5,1.7-0.8,3.5-0.8,5.6c0,1.4,0.2,2.8,0.5,4.2
	c0.3,1.4,0.7,2.5,1.2,3.3c1,1.8,2.5,3.1,4.5,3.8c1.3,0.5,2.6,0.7,4.1,0.7c1.9,0,3.7-0.5,5.5-1.4l0-11h-5.4L51.7,23.8L51.7,23.8z
	 M23.2,26.1v10.9c0,0.4,0,0.8,0.1,1.2h-2.8c0.1-0.4,0.1-0.8,0.1-1.2V13.1c0-0.4,0-0.8-0.1-1.3h7c1.8,0,3.4,0.4,4.9,1.1
	c2.3,1.2,3.5,3.1,3.5,5.7c0,2.1-0.7,3.8-2.2,5.1c-1.7,1.5-4.1,2.3-7.2,2.3L23.2,26.1L23.2,26.1z"></path>
    <rect x="82.2" y="12" class="st1" width="15.8" height="25.9"></rect>
</svg>
<i class="fas fa-lightbulb" id="lights"></i>
</header>
<main>
	<div class="flex f-cont" id="123">
		<div class="left">
			<div>
				Your Playlist
			</div>
			<div id="playlist"></div>
			<div class="empty"><i class="fas fa-carrot"></i><i class="fas fa-carrot"></i><i class="fas fa-carrot"></i><br/>Add your songs :)</div>
		</div>
		<div class="right">
			<div class="s-cont">
				<input type="text" id="search" placeholder="Search" onkeyup='saveValue(this);'/>
				<label>Search</label>
			</div>
			<div id="results"></div>
			<div class="empty"><span><i class="fas fa-carrot"></i><i class="fas fa-carrot"></i><i class="fas fa-carrot"></i><br/>Type in your favorite artist or song</span></div>
		</div>
		<button class="save" id="save-list">Save<i class="fas fa-download"></i></button>
	</div>
</main>
<div class="window" id="save-window">
	<div class="w-cont">
		<h3>Save</h3>
		<form name="yup" action="#"> 
			<div class="play-name">
				<label>Playlist name</label>
				<input type='text' class='input' name='name' required/>
				<label>Min lenght: 3</label>
			</div>
			<div class="email">
				<label>E-Mail</label>
				<input type='email' class='input' name='mail' required/>
				<label>Required format: name@example.com</label>
			</div>
			<div class="butts">
				<input type="button" value="cancel" class="button cancel" />
				<input type="submit" name="submit" class="button" value="Submit" onclick="Saveall(document.yup.name,document.yup.mail)" />
			</div>
		</form>
	</div>
</div>
<script>
let search = document.getElementById("search");
let mainstuff = document.getElementById("123");
let playlist = document.getElementById("playlist");

mainstuff.innerHtml = getSavedValue("allinfo");
search.value = getSavedValue("search");

function saveValue(e){
	var id = e.id;  // get the sender's id to save it.
	var val = e.value; // get the value.
	localStorage.setItem(id, val);// Every time user writing something, the localStorage's value will override.
}
function getSavedValue(v){
	if (!localStorage.getItem(v)) {
		return "";// You can change this to your defualt value.
	}
	return localStorage.getItem(v);
}
let limit = 5
	index = 0;
remIT = (point) =>{
	console.log(point.closest(".row"));
	$(point).closest(".row").replaceWith();
}
addIT = () =>{
	$("#results > .row").on("click",function(){
		console.log(this);
		$("#playlist").append(this);
		$(this).addClass("selected").append("<span class='remove' onclick='remIT(this)'><i class='fas fa-times'></i></span>");
		$(".left .empty").hide();
		localStorage.setItem("allinfo", $("#123 #playlist").html());
		if (localStorage.getItem("allinfo")) {
			console.log(mainstuff);
		}
	});
}
music = (val) =>{
	fetch("https://deezerdevs-deezer.p.rapidapi.com/search?q=" + val.target.value+"&limit=5&index=0", {
		"method": "GET",
		"headers": {
			"x-rapidapi-key": "2b8c48bfefmshdc5ae752139a51fp150905jsnd66c041066a9",
			"x-rapidapi-host": "deezerdevs-deezer.p.rapidapi.com",
		}
	})
	.then(res => res.json())
	.then(response => {
		$(".right .empty").hide();
		if(response.data && response.data.length !=0){
			$("#results").empty();
			response.data.forEach(el => {
				console.log(el);	
				$("#results").append("<div class='row' id="+el.id+"><div><img src="+el.album.cover_small+" alt="+el.title+"/></div><div class='info'><div>"+el.title+"</div><div>"+el.artist.name+"</div></div></div>");
			});
			addIT();
			$("#results").append(`<button class='button' onclick='domooar("${val.target.value}")'>More</button>`);
		}
		else{
			console.log("nope");
			$("#results").empty();
			$("#results").append("<div><p>No results :(</p></div>");
		}
		//$("#results").append("<div>"+JSON.stringify(response.data[0].id)+"</div>");
		//console.log(response.data);
	})
	.catch(err => {
		console.error(err);
	});
}
domooar = (name) => {
	console.log(name,limit);
	limit +=5;
	console.log(limit,index);
	fetch("https://deezerdevs-deezer.p.rapidapi.com/search?q="+name+"&limit="+limit+"&index=0", {
		"method": "GET",
		"headers": {
			"x-rapidapi-key": "2b8c48bfefmshdc5ae752139a51fp150905jsnd66c041066a9",
			"x-rapidapi-host": "deezerdevs-deezer.p.rapidapi.com"
		}
	})
	.then(res => res.json())
	.then(response => {
		$("#results").empty();
		response.data.forEach(el => {
			console.log(document.getElementById(el.id));	
			if(document.getElementById(el.id) == null)
			$("#results").append("<div class='row' id="+el.id+"><div><img src="+el.album.cover_small+" alt="+el.title+"/></div><div class='info'><div>"+el.title+"</div><div>"+el.artist.name+"</div></div></div>");	
		});
		addIT();
		$("#results").append(`<button class='button' onclick='domooar("${name}")'>More</button>`);
		if($("#results").height() > $(".right").height()){
			console.log("HIDE");
		}
		//$("#results").append("<div>"+JSON.stringify(response.data[0].id)+"</div>");
		//console.log(response.data);
	})
	.catch(err => {
		console.error(err);
	});
}
$("#lights").click(function(){
	$("body").toggleClass("night");
});
$("#save-list").click(function(){
	console.log("window");
	$(".window").addClass("show");
});
$(".cancel").click(function(){
	$(".window").removeClass("show");
})
function Saveall(inputText1,inputText2){
	console.log(inputText1.value.length);
	let vaild, nval, eval;
	valid = false;
	nval = false;
	eval = false;
	let mailformat = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
	if(inputText2.value.match(mailformat))
	{
		console.log("GOODE");
		eval = true;
	}else{
		$(".email").addClass("nope");
	}
	if(inputText1.value.length){
		console.log("GOOD");
		nval = true;
	}else{
		$(".play-name").addClass("nope");
	}
	
	if(nval == true && eval == true)
		vaild = true;
	
	if(valid == true){
		return true;
	}else{
		return false;
	}
}
const observerOptions = {
  childList: true,
  attributes: true,
  subtree: true
}
const cb = function(mutationsList, observer) {
    for(const mutation of mutationsList) {
        if (mutation.type === 'childList') {
			if($("#playlist > div").length != 0){
				$("#save-list").addClass("show");
			}else{
				$("#save-list").removeClass("show");
			}
            console.log('A child node has been added or removed.');
        }
        /*else if (mutation.type === 'attributes') {
            console.log('The ' + mutation.attributeName + ' attribute was modified.');
        }*/
    }
};
const observer = new MutationObserver(cb);
observer.observe(playlist, observerOptions)

const input = search;
input.addEventListener('keyup', function(e){
	if (e.keyCode === 13)
		music(e);
});
</script>
</body>
</html>